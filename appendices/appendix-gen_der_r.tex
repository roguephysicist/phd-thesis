\section{Generalized derivative $(\bfr_{nm}(\bfk))_{;\bfk}$}\label{gder}

We obtain the generalized derivative $(\bfr_{nm}(\bfk))_{;\bfk}$.
We start with the basic result
\begin{equation}\label{a_hrdab}
[r^{\rma},p^{\rmb}]=i\hbar\gd_{ab}
,
\end{equation} 
then
\begin{equation}\label{a_hrdab2}
\bra{n\bfk}[r^{\rma},p^{\rmb}]\ket{m\bfk'}=i\hbar\gd_{ab}\gd_{nm}\gd(\bfk-\bfk')
,
\end{equation}
so
\begin{equation}\label{a_hrdab3}
\bra{n\bfk}[r^{\rma}_i,p^{\rmb}]\ket{m\bfk'}
+
\bra{n\bfk}[r^{\rma}_e,p^{\rmb}]\ket{m\bfk'}
=i\hbar\gd_{ab}\gd_{nm}\gd(\bfk-\bfk')
.
\end{equation}
From Eq.~\eqref{conmri3} and ~\eqref{gendev}
\begin{equation}\label{a_rip}
\bra{n\bfk}[r^{\rma}_i,p^{\rmb}]\ket{m\bfk'}
=i\gd(\bfk-\bfk')(p^{\rmb}_{nm})_{;k^{\rma}}
\end{equation}
\begin{equation}\label{a_ripn}
(p^{\rmb}_{nm})_{;k^{\rma}}=
\nabla_{k^{\rma}}
p^{\rmb}_{n m}(\bfk)
-
i
p^{\rmb}_{nm}(\bfk)
\left(
\xi^{\rma}_{nn}(\bfk)
-
\xi^{\rma}_{mm}(\bfk)
\right)
,
\end{equation}
and
\begin{align}\label{a_rep}
\bra{n\bfk}[r^{\rma}_e,p^{\rmb}]\ket{m\bfk'}&=
\sum_{\ell\bfk''}
\bigg(
\bra{n\bfk}r^{\rma}_e\ket{\ell\bfk''}\bra{\ell\bfk''}p^{\rmb}\ket{m\bfk'}
\nonumber \\
&
-
\bra{n\bfk}p^{\rmb}\ket{\ell\bfk''}\bra{\ell\bfk''}r^{\rma}_e\ket{m\bfk'}
\bigg)
\nonumber \\
&=
\sum_{\ell\bfk''}
\bigg(
(1-\gd_{n\ell})\gd(\bfk-\bfk'')\xi^{\rma}_{n\ell}
\gd(\bfk''-\bfk')p^{\rmb}_{\ell m}
\nonumber \\
&-
\gd(\bfk-\bfk'')p^{\rmb}_{n\ell}
(1-\gd_{\ell m})\gd(\bfk''-\bfk')\xi^{\rma}_{\ell m}
\bigg)
\nonumber \\
&=
\gd(\bfk-\bfk')
\sum_{\ell}
\bigg(
(1-\gd_{n\ell})
\xi^{\rma}_{n\ell}
p^{\rmb}_{\ell m}
\nonumber \\
&-
(1-\gd_{\ell m})
p^{\rmb}_{n\ell}
\xi^{\rma}_{\ell m}
\bigg)
\nonumber \\
&=
\gd(\bfk-\bfk')
\bigg(
\sum_{\ell}
\bigg(
\xi^{\rma}_{n\ell}
p^{\rmb}_{\ell m}
-
p^{\rmb}_{n\ell}
\xi^{\rma}_{\ell m}
\bigg)
\nonumber \\
&+
p^{\rmb}_{nm}(\xi^{\rma}_{mm}
-
\xi^{\rma}_{nn}
)
\bigg)
.
\end{align}
Using Eqs.~\eqref{a_rip} and ~\eqref{a_rep}
into Eq.~\eqref{a_hrdab3} gives
\begin{align}\label{a_rapb}
i\gd(\bfk-\bfk')
\bigg(
(p^{\rmb}_{nm})_{;k^{\rma}}
&
-i
\sum_{\ell}
\bigg(
\xi^{\rma}_{n\ell}
p^{\rmb}_{\ell m}
-
p^{\rmb}_{n\ell}
\xi^{\rma}_{\ell m}
\bigg)
\nonumber \\
&
-i
p^{\rmb}_{nm}(\xi^{\rma}_{mm}
-
\xi^{\rma}_{nn}
)
\bigg)
=
i\hbar\gd_{ab}\gd_{nm}\gd(\bfk-\bfk')
,
\end{align}
then
\begin{align}\label{a_rapb2}
(p^{\rmb}_{nm})_{;k^{\rma}}&=
\hbar\gd_{ab}\gd_{nm}
+i
\sum_{\ell}
\bigg(
\xi^{\rma}_{n\ell}
p^{\rmb}_{\ell m}
-
p^{\rmb}_{n\ell}
\xi^{\rma}_{\ell m}
\bigg)
\nonumber \\
&+i
p^{\rmb}_{nm}(\xi^{\rma}_{mm}
-
\xi^{\rma}_{nn}
)
,
\end{align}
and from Eq.~\eqref{a_ripn},
\begin{align}\label{cogno}
\nabla_{k^{\rma}}p^{\rmb}_{nm}=
\hbar\gd_{ab}\gd_{nm}
+i
\sum_{\ell}
\bigg(
\xi^{\rma}_{n\ell}
p^{\rmb}_{\ell m}
-
p^{\rmb}_{n\ell}
\xi^{\rma}_{\ell m}
\bigg)
.
\end{align}
Now, there are two cases. We use Eqs.~\eqref{xir} and ~\eqref{chon.98}.

\noindent {\it Case} $n=m$
\begin{align}\label{tita}
\frac{1}{\hbar}\nabla_{k^{\rma}}p^{\rmb}_{nn}=
\gd_{ab}
-\frac{m_e}{\hbar}
\sum_{\ell}
\go_{\ell n}
\bigg(
r^{\rma}_{n\ell}
r^{\rmb}_{\ell n}
+
r^{\rmb}_{n\ell}
r^{\rma}_{\ell n}
\bigg)
,
\end{align}
that gives the familiar expansion for the inverse effective mass
tensor $(m_n^{-1})_{ab}$.\cite{ashcroft_solid_1976}

\noindent {\it Case} $n\ne m$
\begin{align}\label{mes}
(p^{\rmb}_{nm})_{;k^{\rma}}&=
\hbar\gd_{ab}\gd_{nm}
+i
\sum_{\ell\ne m\ne n}
\bigg(
\xi^{\rma}_{n\ell}
p^{\rmb}_{\ell m}
-
p^{\rmb}_{n\ell}
\xi^{\rma}_{\ell m}
\bigg)
\nonumber\\
&+
i
\bigg(
\xi^{\rma}_{nm}
p^{\rmb}_{mm}
-
p^{\rmb}_{nm}
\xi^{\rma}_{mm}
\bigg)
\nonumber\\
&+
i
\bigg(
\xi^{\rma}_{nn}
p^{\rmb}_{nm}
-
p^{\rmb}_{nn}
\xi^{\rma}_{nm}
\bigg)
+i
p^{\rmb}_{nm}(\xi^{\rma}_{mm}
-
\xi^{\rma}_{nn}
)
\nonumber \\
&=
-m_e
\sum_{\ell}
\bigg(
\go_{\ell m}
r^{\rma}_{n\ell}
r^{\rmb}_{\ell m}
-
\go_{n\ell}
r^{\rmb}_{n\ell}
r^{\rma}_{\ell m}
\bigg)
+i
\xi^{\rma}_{nm}
(p^{\rmb}_{mm}
-
p^{\rmb}_{nn}
)
\nonumber \\
&=
-m_e
\sum_{\ell}
\bigg(
\go_{\ell m} 
r^{\rma}_{n\ell} 
r^{\rmb}_{\ell m}
-
\go_{n\ell} 
r^{\rmb}_{n\ell} 
r^{\rma}_{\ell m}
\bigg)
+i 
m_er^{\rma}_{nm}
\Delta^{\rmb}_{mn}
,
\end{align} 
where
\begin{equation}\label{a_delta}
\Delta^{\rmb}_{mn}=\frac{p^{\rmb}_{mm}-p^{\rmb}_{nn}}{m_e}
.
\end{equation}

Now, for $n \ne m$, Eqs.~\eqref{chon.98},
~\eqref{a_gradw2} and 
~\eqref{mes} and the chain rule, give
\begin{align}\label{a_rgendevn}
(r^{\rmb}_{nm})_{;k^{\rma}}&=\left(\frac{p^{\rmb}_{nm}}{im_e\go_{nm}}\right)_{;k^{\rma}}
=
\frac{1}
{im_e\go_{nm}}
\left(
p^{\rmb}_{nm}
\right)_{;k^{\rma}}
-
\frac{p^{\rmb}_{nm}}
{im_e\go^2_{nm}}
\left(
\go_{nm}
\right)_{;k^{\rma}}
\nonumber \\
&=
\frac{i}{\go_{nm}}
\sum_{\ell}
\bigg(
\go_{\ell m}
r^{\rma}_{n\ell}
r^{\rmb}_{\ell m}
-
\go_{n\ell}
r^{\rmb}_{n\ell}
r^{\rma}_{\ell m}
\bigg)
+
\frac{r^{\rma}_{nm}
\Delta^{\rmb}_{mn}}
{\go_{nm}}
\nonumber \\
&
-
\frac{r^{\rmb}_{nm}}
{\go_{nm}}
\left(
\go_{nm}
\right)_{;k^{\rma}}
\nonumber \\
&=
\frac{i}{\go_{nm}}
\sum_{\ell}
\bigg(
\go_{\ell m}
r^{\rma}_{n\ell}
r^{\rmb}_{\ell m}
-
\go_{n\ell}
r^{\rmb}_{n\ell}
r^{\rma}_{\ell m}
\bigg)
+
\frac{r^{\rma}_{nm}
\Delta^{\rmb}_{mn}}
{\go_{nm}}
\nonumber \\
&
-
\frac{r^{\rmb}_{nm}}
{\go_{nm}}
\frac{p^{\rma}_{nn}-p^{\rma}_{mm}}{m_e}
\nonumber \\
&=
\frac{
r^{\rma}_{nm}
\Delta^{\rmb}_{mn}
+r^{\rmb}_{nm}
\Delta^{\rma}_{mn}
}
{\go_{nm}}
%\nonumber \\
%&
+
\frac{i}{\go_{nm}}
\sum_{\ell}
\bigg(
\go_{\ell m}
r^{\rma}_{n\ell}
r^{\rmb}_{\ell m}
-
\go_{n\ell}
r^{\rmb}_{n\ell}
r^{\rma}_{\ell m}
\bigg)
\end{align}
