\documentclass[aps,letterpaper]{revtex4}
\usepackage{amsmath}
\usepackage[colorlinks=true]{hyperref}

\input{../../base/bms}

\begin{document}

\section{\texorpdfstring{$\mathbf{r}_{e}$ and $\mathbf{r}_{i}$}{re and ri}}
\label{app:re_ri}

In this appendix, we derive the expressions for the matrix elements of the
electron position operator $\mathbf{r}$. The $r$ representation of the Bloch
states is given by
\begin{equation}\label{bloch}
\psi_{n\mathbf{k}}(\mathbf{r})=\langle\mathbf{r}\vert n\mathbf{k}\rangle =
\sqrt{\frac{\Omega}{8\pi^{3}}}
e^{i\mathbf{k} \cdot \mathbf{r}}u_{n\mathbf{k}}(\mathbf{r}),
\end{equation}
where $u_{n\mathbf{k}}(\mathbf{r}) = u_{n\mathbf{k}}(\mathbf{r} + \mathbf{R})$
is cell periodic, and
\begin{equation}\label{normal}
\int_{\Omega}
u_{n\mathbf{k}}^{*}(\mathbf{r})u_{m\mathbf{k}'}(\mathbf{r})\,d^{3}r
= \delta_{nm}\delta_{\mathbf{\mathbf{k},\mathbf{k}'}},
\end{equation}
and $\Omega$ is the unit cell volume.

The key ingredient in the calculation are the matrix elements of the position
operator $\mathbf{r}$. We start from the basic relation
\begin{equation}\label{nbraket}
\langle n\mathbf{k}\vert m\mathbf{k}'\rangle =
\delta_{nm}\delta(\mathbf{k} - \mathbf{k}'),
\end{equation}
and take its derivative with respect to $\mathbf{k}$ as follows. On one hand,
\begin{equation}\label{ddk1}
\frac{\partial}{\partial\mathbf{k}}
\langle n\mathbf{k}\vert m\mathbf{k}'\rangle =
\delta_{nm}\frac{\partial}{\partial\mathbf{k}}\delta(\mathbf{k} - \mathbf{k}'),
\end{equation}
and on the other,
\begin{equation}\label{dkbraket}
\frac{\partial}{\partial\mathbf{k}}\braket{n\mathbf{k}}{m\mathbf{k}'}
= \frac{\partial}{\partial\mathbf{k}}\int
\langle n\mathbf{k}\vert \mathbf{r}\rangle
\langle \mathbf{r}\vert m\mathbf{k}'\rangle
\,d\mathbf{r} 
= \int
\left(
\frac{\partial}{\partial\mathbf{k}}
\psi^{*}_{n\mathbf{k}}(\mathbf{r})
\right)
\psi_{m\mathbf{k}'}(\mathbf{r})\,d\mathbf{r}.
\end{equation}
The derivative of the wavefunction is simply given by
\begin{equation}\label{dpsi}
\frac{\partial}{\partial\mathbf{k}}\psi^{*}_{n\mathbf{k}}(\mathbf{r})
= \sqrt{\frac{\Omega}{8\pi^{3}}}
\left(
\frac{\partial}{\partial\mathbf{k}}
u^{*}_{n\mathbf{k}}(\mathbf{r})
\right)
e^{-i\mathbf{k}\cdot\mathbf{r}} - i\mathbf{r}\psi^{*}_{n\mathbf{k}}(\mathbf{r}).
\end{equation}
Substituting into Eq. \eqref{dkbraket}, we obtain
\begin{align}\label{dkbraket2}
\frac{\partial}{\partial\mathbf{k}}\braket{n\mathbf{k}}{m\mathbf{k}'}
&= \sqrt{\frac{\Omega}{8\pi^{3}}}\int
\left(
\frac{\partial}{\partial\mathbf{k}}
u^{*}_{n\mathbf{k}}(\mathbf{r})\right)e^{-i\mathbf{k}\cdot\mathbf{r}}
\psi_{m\mathbf{k}'}(\mathbf{r})\,d\mathbf{r} 
- i\int\psi^{*}_{n\mathbf{k}}(\mathbf{r})\mathbf{r}
  \psi_{m\mathbf{k}'}(\mathbf{r})\,d\mathbf{r}\nonumber \\
&= \frac{\Omega}{8\pi^{3}}\int
  e^{-i(\mathbf{k}-\mathbf{k}')\cdot\mathbf{r}}
  \left(
  \frac{\partial}{\partial\mathbf{k}}u^{*}_{n\mathbf{k}}(\mathbf{r})
  \right)
u_{m\mathbf{k}'}(\mathbf{r})\,d\mathbf{r}
- i \bra{n\mathbf{k}}\hat{\mathbf{r}}\ket{m\mathbf{k}'}.
\end{align}
Restricting $\mathbf{k}$ and $\mathbf{k}'$ to the first Brillouin zone, we use
the following result that is valid for any periodic function
$f(\mathbf{r}) = f(\mathbf{r} + \mathbf{R})$,
\begin{align}\label{periodic}
\int e^{i(\mathbf{q}-\mathbf{k})\cdot\mathbf{r}}f(\mathbf{r})\,d^{3}r =
\frac{8\pi^{3}}{\Omega}\delta(\mathbf{q} - \mathbf{k})
\int_{\Omega}f(\mathbf{r})\,d^{3}r,
\end{align}
to finally write \cite{blountSSP62}
\begin{align}\label{dkbraket3}
\frac{\partial}{\partial\mathbf{k}}
\langle n\mathbf{k}\vert m\mathbf{k}'\rangle
&= \delta(\mathbf{k}-\mathbf{k}')\int_{\Omega}
\left(
\frac{\partial}{\partial\mathbf{k}} u^{*}_{n\mathbf{k}}(\mathbf{r})
\right)
u_{m\mathbf{k}}(\mathbf{r})\,d\mathbf{r}
-i\bra{n\mathbf{k}}\hat{\mathbf{r}}\ket{m\mathbf{k}'}.
\end{align}
From
\begin{align}\label{dnm1}
\int_{\Omega}u_{m\mathbf{k}} u^{*}_{n\mathbf{k}}\,d\mathbf{r} = \delta_{nm},
\end{align}
we easily find that
\begin{align}\label{dnm2}
\int_{\Omega}
\left(
\frac{\partial}{\partial\mathbf{k}} u_{m\mathbf{k}}(\mathbf{r})
\right)
u^{*}_{n\mathbf{k}}(\mathbf{r})\,d\mathbf{r}
= -\int_{\Omega}u_{m\mathbf{k}}(\mathbf{r})
\left(
\frac{\partial}{\partial\mathbf{k}} u^{*}_{n\mathbf{k}}(\mathbf{r})
\right)\,d\mathbf{r}.
\end{align}
Therefore, we define
\begin{align}\label{zeta}
\boldsymbol{\xi}_{nm}(\mathbf{k}) \equiv
i\int_{\Omega}u^{*}_{n\mathbf{k}}(\mathbf{r})\nabla_{\mathbf{k}}
u_{m\mathbf{k}}(\mathbf{r})\,d\mathbf{r},
\end{align} 
with $\nabla_{\mathbf{k}} = \partial/\partial\mathbf{k}$. Now, from Eqs.
\eqref{ddk1}, \eqref{dkbraket2}, and  \eqref{zeta}, we have that the matrix
elements of the position operator of the electron are given by
\begin{align}\label{erre}
\langle n\mathbf{k}\vert \hat{\mathbf{r}} \vert m\mathbf{k}'\rangle 
= \delta(\mathbf{k}-\mathbf{k}')\boldsymbol{\xi}_{nm}(\mathbf{k})
+ i\delta_{nm}\nabla_{\mathbf{k}}\delta(\mathbf{k}-\mathbf{k}'),
\end{align}
Then, from Eq. \eqref{erre} and writing $\hat{\mathbf{r}} = \hat{\mathbf{r}}_{e}
+ \hat{\mathbf{r}}_{i}$, with $\hat{\mathbf{r}}_{e}$ ($\hat{\mathbf{r}}_{i}$)
the interband (intraband) part, we obtain that
\begin{align}\label{rnmi}
\langle n\mathbf{k}\vert \hat{\mathbf{r}}_{i} \rangle m\mathbf{k}'\vert
&= \delta_{nm}
\left[
  \delta(\mathbf{k}-\mathbf{k}')\boldsymbol{\xi}_{nn}(\mathbf{k})
+ i\nabla_{\mathbf{k}}\delta(\mathbf{k} - \mathbf{k}')
\right],\\
\langle n\mathbf{k}\vert \hat{\mathbf{r}}_e \rangle m\mathbf{k}'\vert
&= (1 - \delta_{nm})\delta(\mathbf{k}-\mathbf{k}')
   \boldsymbol{\xi}_{nm}(\mathbf{k}).
\label{rnme}
\end{align} 

To proceed, we relate Eq. \eqref{rnme} to the matrix elements of the momentum
operator as follows. For the intraband part, we derive the following general
result,
\begin{align}\label{conmri}
\bra{n\mathbf{k}}[\hat{\mathbf{r}}_{i},\hat\calo]\ket{m\mathbf{k}'}
&=
\sum_{\ell,\mathbf{k}''}
\left(
\bra{n\mathbf{k}}
\hat{\mathbf{r}}_{i}
\ket{\ell\mathbf{k}''}
\bra{\ell\mathbf{k}''}
\hat\calo
\ket{m\mathbf{k}'}
\right.
\nonumber \\
&
\left.
-
\bra{n\mathbf{k}}
\hat\calo
\ket{\ell\mathbf{k}''}
\bra{\ell\mathbf{k}''}
\hat{\mathbf{r}}_{i}
\ket{m\mathbf{k}'}
\right)
\nonumber \\
&=
\sum_{\ell}
\left(
\bra{n\mathbf{k}}
\hat{\mathbf{r}}_{i}
\ket{\ell\mathbf{k}'}
\calo_{\ell m}(\mathbf{k}')
\right.
\nonumber \\
&
\left.
-
\calo_{n\ell}(\mathbf{k})
\ket{\ell\mathbf{k}}
\bra{\ell\mathbf{k}}
\hat{\mathbf{r}}_{i}
\ket{m\mathbf{k}'}
\right)
,
\end{align}
where we have taken
$\bra{n\mathbf{k}}\hat\calo\ket{\ell\mathbf{k}''}=\delta(\mathbf{k}-\mathbf{k}'')\calo_{n\ell}(\mathbf{k})$.
We substitute Eq. \eqref{rnmi}, to obtain
\begin{align}\label{conmri2}
\sum_{\ell}&
\left(
\delta_{n\ell}\left[\delta(\mathbf{k}-\mathbf{k}')\boldsymbol{\xi}_{nn}(\mathbf{k})
+i\nabla_{\mathbf{k}}\delta(\mathbf{k}-\mathbf{k}')\right]
\calo_{\ell m}(\mathbf{k}')
\right.
\nonumber \\
&
\left.
-
\calo_{n\ell}(\mathbf{k})
\delta_{\ell m}\left[\delta(\mathbf{k}-\mathbf{k}')\boldsymbol{\xi}_{mm}(\mathbf{k})
+i\nabla_{\mathbf{k}}\delta(\mathbf{k}-\mathbf{k}')\right]
\right)
\nonumber\\
&=
\left(
\left[\delta(\mathbf{k}-\mathbf{k}')\boldsymbol{\xi}_{nn}(\mathbf{k})
+i\nabla_{\mathbf{k}}\delta(\mathbf{k}-\mathbf{k}')\right]
\calo_{n m}(\mathbf{k}')
\right.
\nonumber \\
&-
\left.
\calo_{nm}(\mathbf{k})
\left[\delta(\mathbf{k}-\mathbf{k}')\boldsymbol{\xi}_{mm}(\mathbf{k})
+i\nabla_{\mathbf{k}}\delta(\mathbf{k}-\mathbf{k}')\right]
\right)
\nonumber\\
&=
\delta(\mathbf{k}-\mathbf{k}')
\calo_{nm}(\mathbf{k})
\left(
\boldsymbol{\xi}_{nn}(\mathbf{k})
-
\boldsymbol{\xi}_{mm}(\mathbf{k})
\right)
+i\calo_{n m}(\mathbf{k}')
\nabla_{\mathbf{k}}
\delta(\mathbf{k}-\mathbf{k}')
\nonumber \\
&+i
\delta(\mathbf{k}-\mathbf{k}')
\nabla_{\mathbf{k}}
\calo_{n m}(\mathbf{k})
-
i\calo_{n m}(\mathbf{k}')
\nabla_{\mathbf{k}}\delta(\mathbf{k}-\mathbf{k}')
\nonumber \\
&=
i\delta(\mathbf{k}-\mathbf{k}')
\bigg(
\nabla_{\mathbf{k}}
\calo_{n m}(\mathbf{k})
-
i
\calo_{nm}(\mathbf{k})
\left(
\boldsymbol{\xi}_{nn}(\mathbf{k})
-
\boldsymbol{\xi}_{mm}(\mathbf{k})
\right)
\bigg)
\nonumber \\
&\equiv
i\delta(\mathbf{k}-\mathbf{k}')(\calo_{nm})_{;\mathbf{k}}
.
\end{align}
Then,
\begin{align}\label{conmri3}
\bra{n\mathbf{k}}[\hat{\mathbf{r}}_{i},\hat\calo]\ket{m\mathbf{k}'}
=i\delta(\mathbf{k}-\mathbf{k}')(\calo_{nm})_{;\mathbf{k}}
,
\end{align}   
with
\begin{align}\label{gendev}
(\calo_{nm})_{;\mathbf{k}}=
\nabla_{\mathbf{k}}
\calo_{n m}(\mathbf{k})
-  
i
\calo_{nm}(\mathbf{k})
\left(
\boldsymbol{\xi}_{nn}(\mathbf{k})
-
\boldsymbol{\xi}_{mm}(\mathbf{k})
\right)
,
\end{align}  
the generalized derivative of $\calo_{nm}$ with respect to $\mathbf{k}$.
Note that the highly singular term $\nabla_{\mathbf{k}}\delta(\mathbf{k}-\mathbf{k}')$
cancels in Eq. \eqref{conmri2}, thus giving a well defined commutator
of the intraband position operator with an arbitrary operator $\hat\calo$.
We use Eq. \eqref{chon.98} and \eqref{conmri3}  in the next section.

\bibliographystyle{unsrt}
\bibliography{/Users/sma/Dropbox/docs/academics/master}

\end{document}
